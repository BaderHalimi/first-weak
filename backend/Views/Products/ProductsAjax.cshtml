@{
    ViewData["Title"] = "Products";
}

<div class="container mt-4">
    <h2>Client side fetching</h2>
    <table class="table table-striped table-bordered" id="productsTable">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>img</th>
                <th>title</th>
                <th>description</th>
                <th>price</th>
                <th>rate</th>
                <th>stock</th>
            </tr>
        </thead>
        <tbody id="productsTableBody">
        </tbody>
    </table>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        $.ajax({
            url: 'https://dummyjson.com/products',
            method: 'GET',
            dataType: 'json',
            success: function(response) {
                
                var products = response.products;
                var tbody = $('#productsTableBody');
                
                products.forEach(function(product) {
                    var row = '<tr>' +
                        '<td>' + product.id + '</td>' +
                        '<td><img src="' + product.thumbnail + '" alt="' + product.title + '" style="width: 50px; height: 50px; object-fit: cover;"></td>' +
                        '<td>' + product.title + '</td>' +
                        '<td>' + product.description.substring(0, 50) + '...</td>' +
                        '<td>$' + product.price.toFixed(2) + '</td>' +
                        '<td>' + product.rating + ' </td>' +
                        '<td>' + product.stock + '</td>' +
                        '</tr>';
                    tbody.append(row);
                });
            },
            error: function() {
                $('#productsTableBody').append('<tr><td colspan="7" class="text-danger">Failed while loading data</td></tr>');
            }
        });
    });
</script>